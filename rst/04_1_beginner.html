

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Beginner &mdash; SWAP-IT Cyber-Physical Factory 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Intermediate" href="04_2_intermediate.html" />
    <link rel="prev" title="Getting Started" href="04_0_getting_started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SWAP-IT Cyber-Physical Factory
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="02_overview_introduction.html">Introduction to Use Case</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_architecture.html">Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="04_0_getting_started.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="04_0_getting_started.html#requirements-and-installation">Requirements and Installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="04_0_getting_started.html#tutorials">Tutorials</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Beginner</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#start-a-single-skill-server">Start a single skill server</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-multiple-skill-servers">Start multiple skill servers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="04_2_intermediate.html">Intermediate</a></li>
<li class="toctree-l3"><a class="reference internal" href="04_3_advanced.html">Advanced</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="05_how_to_guides.html">How-to-Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_related_projects.html">Related Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_contact.html">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SWAP-IT Cyber-Physical Factory</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="04_0_getting_started.html">Getting Started</a></li>
      <li class="breadcrumb-item active">Beginner</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/rst/04_1_beginner.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="beginner">
<h1>Beginner<a class="headerlink" href="#beginner" title="Link to this heading"></a></h1>
<p>This tutorial demonstrates how to set up skill servers using the skill-based control framework and how to invoke and execute skills using two different methods. This ensures that the assets on the shop floor side are prepared for the machine connector.</p>
<p>Users who are already familiar with the skill-based control framework can skip directly to the next tutorial.</p>
<p>The Python packages for the skill-based control framework that are required to run this tutorial and detailed instructions for installing and deploying the framework can be found in the following repositories:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://github.com/cognitive-production/skillbasedcontrol-statemachine">SBC Statemachine Project</a> (class implementing the Module Type Package (MTP) service statemachine and all necessary data structures)</p></li>
<li><p><a class="reference external" href="https://github.com/cognitive-production/skillbasedcontrol-server">SBC Server Project</a> (classes for implementing skills in python and provide them via an opc ua server)</p></li>
<li><p><a class="reference external" href="https://github.com/cognitive-production/skillbasedcontrol-communication">SBC Communication Project</a> (class for communicating with skills implemented in assets with a SkillBasedControlFramework)</p></li>
</ul>
</div></blockquote>
<p>Please navigate to the <em>01_beginner</em> folder of the repository to start the beginner tutorial.</p>
<section id="start-a-single-skill-server">
<h2>Start a single skill server<a class="headerlink" href="#start-a-single-skill-server" title="Link to this heading"></a></h2>
<p>To configure a skill, based on a JSON file, and start a skill server providing this skill, the following lines of code are necessary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">glob</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">os</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">json</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kn">from</span> <span class="nn">sbc_statemachine.skilldatahandle</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos"> 7</span>    <span class="n">SkillDataHandle</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="kn">from</span> <span class="nn">sbc_server.skillimplementations</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos">10</span>    <span class="n">ExternalExecuteSkill</span><span class="p">,</span>
<span class="linenos">11</span><span class="p">)</span>
<span class="linenos">12</span><span class="kn">from</span> <span class="nn">sbc_server.skillserver_opcua_vc</span> <span class="kn">import</span> <span class="n">SkillServer_OPCUA_VC</span>
<span class="linenos">13</span><span class="kn">from</span> <span class="nn">sbc_server.runskillserverhelper</span> <span class="kn">import</span> <span class="n">run_skillserver</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="c1"># Specify the path to the json files subdirectory</span>
<span class="linenos">16</span><span class="n">json_directory_path</span> <span class="o">=</span> <span class="s2">&quot;skills/&quot;</span>
<span class="linenos">17</span><span class="c1"># empty list for storage of skills</span>
<span class="linenos">18</span><span class="n">skills</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">19</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="c1"># 1. Implement custom skill class inheriting from ExternalExecuteSkill</span>
<span class="linenos">22</span><span class="k">class</span> <span class="nc">CustomSkill</span><span class="p">(</span><span class="n">ExternalExecuteSkill</span><span class="p">):</span>
<span class="linenos">23</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_file</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">24</span>        <span class="n">data</span> <span class="o">=</span> <span class="n">SkillDataHandle</span><span class="p">()</span>
<span class="linenos">25</span>        <span class="n">data</span><span class="o">.</span><span class="n">set_fromJsonFile</span><span class="p">(</span><span class="n">json_file</span><span class="p">,</span> <span class="n">toSkillDataDefault</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">26</span>        <span class="n">data</span><span class="o">.</span><span class="n">reset_SkillDataCommand</span><span class="p">()</span>
<span class="linenos">27</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="linenos">28</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="n">machine_name</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
<span class="linenos">31</span>    <span class="c1"># 2. Create object of custom skill class</span>
<span class="linenos">32</span>    <span class="c1"># Use glob to find all JSON files in the subdirectory</span>
<span class="linenos">33</span>    <span class="n">json_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">json_directory_path</span><span class="p">,</span> <span class="s2">&quot;*.json&quot;</span><span class="p">))</span>
<span class="linenos">34</span>    <span class="k">for</span> <span class="n">json_file</span> <span class="ow">in</span> <span class="n">json_files</span><span class="p">:</span>
<span class="linenos">35</span>        <span class="k">if</span> <span class="n">machine_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">json_file</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
<span class="linenos">36</span>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span class="linenos">37</span>                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="linenos">38</span>                <span class="n">skill_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strName&quot;</span><span class="p">)</span>
<span class="linenos">39</span>            <span class="n">skills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span class="linenos">40</span>                <span class="n">CustomSkill</span><span class="p">(</span><span class="n">json_directory_path</span> <span class="o">+</span> <span class="n">skill_name</span> <span class="o">+</span> <span class="n">machine_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">)</span>
<span class="linenos">41</span>            <span class="p">)</span>
<span class="linenos">42</span>
<span class="linenos">43</span>    <span class="c1"># 3. create skillserver object and inject custom skill objects</span>
<span class="linenos">44</span>    <span class="n">skill_server_OPCUA</span> <span class="o">=</span> <span class="n">SkillServer_OPCUA_VC</span><span class="p">(</span>
<span class="linenos">45</span>        <span class="n">skills</span><span class="p">,</span>
<span class="linenos">46</span>        <span class="n">skill_cycletime</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="linenos">47</span>        <span class="n">server_cycletime</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">48</span>        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
<span class="linenos">49</span>    <span class="p">)</span>
<span class="linenos">50</span>    <span class="c1"># 4. start skillserver, for example using run_skillserver from runskillserverhelper</span>
<span class="linenos">51</span>    <span class="n">run_skillserver</span><span class="p">(</span><span class="n">skill_server_OPCUA</span><span class="p">)</span>
<span class="linenos">52</span>
<span class="linenos">53</span>
<span class="linenos">54</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">55</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="linenos">56</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">57</span>        <span class="s2">&quot;--machine&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;TestMachine&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide name of machine&quot;</span>
<span class="linenos">58</span>    <span class="p">)</span>
<span class="linenos">59</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--port&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">4840</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide port of server&quot;</span><span class="p">)</span>
<span class="linenos">60</span>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="linenos">61</span>    <span class="n">server</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">machine</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Explanation of code</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 87.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>line number</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>16</p></td>
<td><p>defines the file path for the JSON files, that specifies the skills</p></td>
</tr>
<tr class="row-odd"><td><p>22-27</p></td>
<td><p>definition of skill class</p></td>
</tr>
<tr class="row-even"><td><p>30-41</p></td>
<td><p>matching of JSON filenames in <em>skills</em> folder with given <em>machine_name</em></p></td>
</tr>
<tr class="row-odd"><td><p>44-49</p></td>
<td><p>configuration of skill server with given <em>port</em></p></td>
</tr>
<tr class="row-even"><td><p>51</p></td>
<td><p>start of skill server</p></td>
</tr>
</tbody>
</table>
<p>There are two methods to implement this example in the context of this tutorial. The first option is to install the three Python packages listed above according to the instructions in the corresponding repositories. The server can then be started via the command line interface with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>start_skill_server<span class="w"> </span>--machine<span class="w"> </span><span class="s2">&quot;Robot&quot;</span><span class="w"> </span>--port<span class="w"> </span><span class="m">4841</span>
</pre></div>
</div>
<p>The <em>–machine</em> option is used to find the corresponding JSON file in the “skills” folder. The <em>–port</em> option specifies the port of the localhost at which the server will be available.</p>
<p>The JSON file defining the <em>PickSkill</em> for the <em>Robot</em> looks like this:</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="p">{</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="nt">&quot;strName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PickSkill&quot;</span><span class="p">,</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="nt">&quot;strType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pick&quot;</span><span class="p">,</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="nt">&quot;strGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="nt">&quot;strDescription&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Skill to pick a part&quot;</span><span class="p">,</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="nt">&quot;iParameterCount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="nt">&quot;astParameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 8</span><span class="w">        </span><span class="p">{</span>
<span class="linenos"> 9</span><span class="w">            </span><span class="nt">&quot;strName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
<span class="linenos">10</span><span class="w">            </span><span class="nt">&quot;strValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
<span class="linenos">11</span><span class="w">            </span><span class="nt">&quot;strUnit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos">12</span><span class="w">            </span><span class="nt">&quot;strDescr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="linenos">13</span><span class="w">        </span><span class="p">},</span>
<span class="linenos">14</span><span class="w">        </span><span class="p">{</span>
<span class="linenos">15</span><span class="w">            </span><span class="nt">&quot;strName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
<span class="linenos">16</span><span class="w">            </span><span class="nt">&quot;strValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
<span class="linenos">17</span><span class="w">            </span><span class="nt">&quot;strUnit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos">18</span><span class="w">            </span><span class="nt">&quot;strDescr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="linenos">19</span><span class="w">        </span><span class="p">},</span>
<span class="linenos">20</span><span class="w">        </span><span class="p">{</span>
<span class="linenos">21</span><span class="w">            </span><span class="nt">&quot;strName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;z&quot;</span><span class="p">,</span>
<span class="linenos">22</span><span class="w">            </span><span class="nt">&quot;strValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
<span class="linenos">23</span><span class="w">            </span><span class="nt">&quot;strUnit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos">24</span><span class="w">            </span><span class="nt">&quot;strDescr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="linenos">25</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">26</span><span class="w">    </span><span class="p">]</span>
<span class="linenos">27</span><span class="p">}</span>
</pre></div>
</div>
<p>The JSON file defines the skill name and the skill parameters.</p>
<p>The second option is to start the server using a YAML file and docker compose. You can start a docker container by executing the following bash command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>compose<span class="w"> </span>-f<span class="w"> </span>docker-compose-start-1-skill-server.yml<span class="w"> </span>-p<span class="w"> </span>beginner<span class="w"> </span>up<span class="w"> </span>-d
</pre></div>
</div>
<p>The file <em>docker-compose-start-skill-server.yml</em> looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nt">Skill_Server_Robot</span><span class="p">:</span>
<span class="linenos">2</span><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">robot</span>
<span class="linenos">3</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ghcr.io/swap-it/cyberphysicalfactory/skill-server:latest</span>
<span class="linenos">4</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="linenos">5</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;4841:4840&quot;</span>
<span class="linenos">6</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="linenos">7</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./skills:/usr/skill_server/skills</span>
<span class="linenos">8</span><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;start_skill_server.py&quot;</span><span class="p p-Indicator">,</span><span class="nv">--machine</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Robot</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Explanation of code</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 87.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>line number</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>4-5</p></td>
<td><p>definition of port at which the skill server is available</p></td>
</tr>
<tr class="row-odd"><td><p>6-7</p></td>
<td><p><em>skills</em> folder is mounted to the container</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>execution of <em>start_skill_server.py</em> module with <em>machine_name</em> <em>Robot</em></p></td>
</tr>
</tbody>
</table>
<p>You can use an OPC-UA client tool like <em>UaExpert</em> to check the state of the skill server. For our example it looks like this:</p>
<figure class="align-center" id="id3">
<img alt="../_images/uaexpert_1server_idle_beginner.PNG" src="../_images/uaexpert_1server_idle_beginner.PNG" />
<figcaption>
<p><span class="caption-text"><em>UaExpert</em> view on <em>Robot</em> skill server. The server is in state (4) <em>idle</em> waiting for execution.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The <em>PickSkill</em> is in state (4) <em>idle</em>. With the following Python code, the <em>PickSkill</em> of the <em>Robot</em> skill server is executed, transfering the server state form <em>idle</em> (4) to <em>execute</em> (6):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">sbc_communication.assetskillshandle</span> <span class="kn">import</span> <span class="n">AssetSkillsHandle</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">sbc_communication.assetskillscommunication_factory</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos"> 3</span>    <span class="n">createSkillCom_Python_Asyncua</span><span class="p">,</span>
<span class="linenos"> 4</span><span class="p">)</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="n">skillComm</span> <span class="o">=</span> <span class="n">createSkillCom_Python_Asyncua</span><span class="p">(</span>
<span class="linenos"> 7</span>    <span class="n">opc_url</span><span class="o">=</span><span class="s2">&quot;opc.tcp://127.0.0.1:4841&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># create asset skills handle, inject the skill communication object</span>
<span class="linenos">11</span><span class="n">assetHandle</span> <span class="o">=</span> <span class="n">AssetSkillsHandle</span><span class="p">(</span>
<span class="linenos">12</span>    <span class="n">assetName</span><span class="o">=</span><span class="s2">&quot;LocalPythonAsset&quot;</span><span class="p">,</span> <span class="n">assetSkillCommunication</span><span class="o">=</span><span class="n">skillComm</span>
<span class="linenos">13</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="n">availableSkills</span> <span class="o">=</span> <span class="n">assetHandle</span><span class="o">.</span><span class="n">read_availableSkills</span><span class="p">()</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="n">skillName</span> <span class="o">=</span> <span class="s2">&quot;PickSkill&quot;</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="c1"># read actual skilldata (SkillData) as reference</span>
<span class="linenos">20</span><span class="n">skilldata</span> <span class="o">=</span> <span class="n">assetHandle</span><span class="o">.</span><span class="n">read_stSkillData</span><span class="p">(</span><span class="n">skillName</span><span class="p">)</span>
<span class="linenos">21</span><span class="c1"># reset skillDataCommand</span>
<span class="linenos">22</span><span class="n">skilldata</span><span class="o">.</span><span class="n">reset_SkillDataCommand</span><span class="p">()</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="c1"># set new skill parameters in stSkillDataCommand, you have to know about each parameter</span>
<span class="linenos">25</span><span class="n">skilldata</span><span class="o">.</span><span class="n">stSkillDataCommand</span><span class="o">.</span><span class="n">astParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strValue</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">26</span><span class="n">skilldata</span><span class="o">.</span><span class="n">stSkillDataCommand</span><span class="o">.</span><span class="n">astParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strValue</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">27</span><span class="n">skilldata</span><span class="o">.</span><span class="n">stSkillDataCommand</span><span class="o">.</span><span class="n">astParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strValue</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="c1"># execute skill, skill parameters from skilldata will be written inside</span>
<span class="linenos">30</span><span class="n">result</span> <span class="o">=</span> <span class="n">assetHandle</span><span class="o">.</span><span class="n">skillExecHandler</span><span class="o">.</span><span class="n">executeSkill</span><span class="p">(</span><span class="n">skillName</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Explanation of code</span><a class="headerlink" href="#id4" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 12.5%" />
<col style="width: 87.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>line number</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>25-27</p></td>
<td><p>setting of skill parameters</p></td>
</tr>
<tr class="row-odd"><td><p>30</p></td>
<td><p>execution of skill, transfering the skill to state (6) <em>execute</em></p></td>
</tr>
</tbody>
</table>
<figure class="align-center" id="id5">
<img alt="../_images/uaexpert_1server_executing_beginner.PNG" src="../_images/uaexpert_1server_executing_beginner.PNG" />
<figcaption>
<p><span class="caption-text"><em>UaExpert</em> view on <em>Robot</em> skill server. The server is in state (6) <em>execute</em>.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Once the <em>complete</em> flag is set to <em>True</em> the skill state is transfered to state (17) <em>completed</em>.</p>
<figure class="align-center" id="id6">
<img alt="../_images/uaexpert_1server_completed_beginner.PNG" src="../_images/uaexpert_1server_completed_beginner.PNG" />
<figcaption>
<p><span class="caption-text"><em>UaExpert</em> view on <em>Robot</em> skill server. The server is in state (17) <em>completed</em>.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="start-multiple-skill-servers">
<h2>Start multiple skill servers<a class="headerlink" href="#start-multiple-skill-servers" title="Link to this heading"></a></h2>
<p>As soon as multiple skill servers are to be started, the first methode demonstrated above becomes cumbersome. With the second method it is much easier. The following simple example will illustrate this.
In addition to the <em>Robot</em> skill server, we will now start a skill server for a <em>ToolMachine</em> by running the following command in a terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>compose<span class="w"> </span>-f<span class="w"> </span>docker-compose-start-2-skill-servers.yml<span class="w"> </span>-p<span class="w"> </span>beginner<span class="w"> </span>up<span class="w"> </span>-d
</pre></div>
</div>
<p>The YAML file looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nt">services</span><span class="p">:</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="nt">Skill_Server_Robot</span><span class="p">:</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">robot</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ghcr.io/swap-it/cyberphysicalfactory/skill-server:latest</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;4841:4840&quot;</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./skills:/usr/skill_server/skills</span>
<span class="linenos">10</span><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;start_skill_server.py&quot;</span><span class="p p-Indicator">,</span><span class="nv">--machine</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Robot</span><span class="p p-Indicator">]</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="nt">Skill_Server_ToolMachine</span><span class="p">:</span>
<span class="linenos">13</span><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">toolmachine</span>
<span class="linenos">14</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ghcr.io/swap-it/cyberphysicalfactory/skill-server:latest</span>
<span class="linenos">15</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="linenos">16</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;4842:4840&quot;</span>
<span class="linenos">17</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="linenos">18</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./skills:/usr/skill_server/skills</span>
<span class="linenos">19</span><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;start_skill_server.py&quot;</span><span class="p p-Indicator">,</span><span class="nv">--machine</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">ToolMachine</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>This way it is very easy to scale an application by simply copying, pasting and customizing the same lines of code in the YAML file.</p>
<p>In <em>Docker Desktop</em> it should look like this:</p>
<figure class="align-center" id="id7">
<img alt="../_images/docker_desktop_beginner.PNG" src="../_images/docker_desktop_beginner.PNG" />
<figcaption>
<p><span class="caption-text"><em>Docker Desktop</em> view on <em>Robot</em> and <em>ToolMachine</em> skill servers.</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>In <em>Docker Desktop</em> the user can inspect and interact with the containers easily.</p>
<p>The user is in a position now to define skills, configure and start skill servers and call skills either by executing Python scripts or by starting docker compose projects.
In the next tutorial, the user will learn how to set up a <em>module server</em> to connect the skill server to the SWAP-IT software architecture.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="04_0_getting_started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="04_2_intermediate.html" class="btn btn-neutral float-right" title="Intermediate" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Fraunhofer IWU.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>